# ============================================================================
# QUANTUM TRADER v2.0 - PRODUCTION SECURITY CONFIGURATION
# ============================================================================
# Add these to your .env file for HTTPS, Authentication, and Caching

# ============================================================================
# JWT AUTHENTICATION
# ============================================================================
# Generate secret key with: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=CHANGE_THIS_TO_SECURE_RANDOM_STRING_IN_PRODUCTION

# Token expiration times (in minutes and days)
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# JWT Algorithm (recommended: HS256)
JWT_ALGORITHM=HS256

# ============================================================================
# API KEY AUTHENTICATION (Alternative to JWT)
# ============================================================================
# Generate keys with: python -c "import secrets; print(secrets.token_urlsafe(32))"
API_KEY_ADMIN=CHANGE_THIS_ADMIN_API_KEY_IN_PRODUCTION
API_KEY_USER=CHANGE_THIS_USER_API_KEY_IN_PRODUCTION

# ============================================================================
# RATE LIMITING
# ============================================================================
# Requests per time window (per user/IP)
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SECONDS=60

# Admin users exempt from rate limiting (comma-separated usernames)
RATE_LIMIT_EXEMPT_USERS=admin,system

# ============================================================================
# REDIS CONFIGURATION (for caching and rate limiting)
# ============================================================================
REDIS_URL=redis://localhost:6379
REDIS_MAX_CONNECTIONS=50
REDIS_DECODE_RESPONSES=true

# Cache TTL defaults (in seconds)
CACHE_TTL_TRADING=5
CACHE_TTL_RISK=10
CACHE_TTL_OVERVIEW=30
CACHE_TTL_SIGNALS=15

# ============================================================================
# HTTPS/SSL CONFIGURATION
# ============================================================================
# Force HTTPS redirect (set to 'true' in production)
FORCE_HTTPS=false

# SSL Certificate paths (for production)
SSL_CERTFILE=certs/cert.pem
SSL_KEYFILE=certs/key.pem

# SSL Certificate chain (optional, for production)
# SSL_CA_BUNDLE=/etc/letsencrypt/live/yourdomain.com/chain.pem

# ============================================================================
# SECURITY HEADERS
# ============================================================================
# Content Security Policy (adjust for your frontend domain)
CSP_DIRECTIVES=default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://testnet.binance.vision;

# ============================================================================
# USER MANAGEMENT (for initial setup)
# ============================================================================
# Default admin user (created on first startup)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=CHANGE_THIS_ADMIN_PASSWORD_IN_PRODUCTION

# User database (SQLite for simplicity, or PostgreSQL URL)
# USER_DATABASE_URL=sqlite:///./users.db
# USER_DATABASE_URL=postgresql://user:pass@localhost/quantum_trader_users

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================
# Session timeout (in minutes)
SESSION_TIMEOUT_MINUTES=60

# Maximum concurrent sessions per user
MAX_SESSIONS_PER_USER=3

# Session storage backend (redis or database)
SESSION_STORAGE=redis

# ============================================================================
# AUDIT LOGGING
# ============================================================================
# Enable audit logging for sensitive operations
AUDIT_LOG_ENABLED=true
AUDIT_LOG_FILE=logs/audit.log

# Log retention (in days)
AUDIT_LOG_RETENTION_DAYS=90

# Events to audit (comma-separated)
AUDIT_EVENTS=login,logout,order_create,order_cancel,settings_change,user_create,user_delete

# ============================================================================
# PRODUCTION DEPLOYMENT NOTES
# ============================================================================
# 
# 1. HTTPS SETUP:
#    - For production, use Let's Encrypt: certbot certonly --standalone -d yourdomain.com
#    - Update SSL_CERTFILE and SSL_KEYFILE paths
#    - Set FORCE_HTTPS=true
#    - Use nginx reverse proxy for better performance
#
# 2. AUTHENTICATION:
#    - Generate strong JWT_SECRET_KEY (minimum 32 characters)
#    - Use different API keys for admin and user roles
#    - Enable rate limiting in production
#    - Create admin user on first startup
#
# 3. REDIS:
#    - Use Redis 6.0+ for better security (ACLs)
#    - Configure Redis password: redis://user:password@localhost:6379
#    - Use Redis Sentinel or Cluster for high availability
#    - Enable Redis persistence (RDB or AOF)
#
# 4. DATABASE:
#    - Use PostgreSQL in production (not SQLite)
#    - Enable SSL for database connections
#    - Regular backups of user database
#
# 5. MONITORING:
#    - Monitor failed login attempts
#    - Track rate limit violations
#    - Alert on security events
#    - Regular security audits
#
# 6. UPDATES:
#    - Keep dependencies updated (pip list --outdated)
#    - Monitor CVE databases for vulnerabilities
#    - Test security updates in staging first
#
# ============================================================================

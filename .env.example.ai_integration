# ==============================================================================
# QUANTUM TRADER - AI SYSTEM INTEGRATION CONFIGURATION
# ==============================================================================
# This file contains all environment variables for integrating AI subsystems.
# Copy this to .env and adjust values as needed.
#
# SAFETY NOTICE:
# - All subsystems default to OFF for backward compatibility
# - Start with OBSERVATION stage and gradually enable subsystems
# - Use TESTNET before enabling on mainnet
# ==============================================================================

# ==============================================================================
# MASTER INTEGRATION CONTROLS
# ==============================================================================

# Integration Stage: Controls overall system behavior
# Options: OBSERVATION | PARTIAL | COORDINATION | AUTONOMY
# - OBSERVATION: All subsystems log decisions but don't enforce
# - PARTIAL: Selective enforcement (confidence, sizing)
# - COORDINATION: AI-HFOS coordinates all subsystems
# - AUTONOMY: Full autonomous mode (TESTNET ONLY!)
QT_AI_INTEGRATION_STAGE=OBSERVATION

# Emergency Controls
QT_AI_EMERGENCY_BRAKE=false          # If true, all AI systems shut down immediately
QT_AI_FAIL_SAFE=true                 # If true, errors cause safe fallback (not crash)

# Global Risk Limits
QT_AI_MAX_DAILY_DD=5.0               # Max daily drawdown % (emergency brake)
QT_AI_MAX_OPEN_DD=10.0               # Max open drawdown % (emergency brake)

# ==============================================================================
# AI HEDGEFUND OPERATING SYSTEM (AI-HFOS)
# ==============================================================================
# Supreme meta-intelligence coordinator - oversees all AI subsystems

QT_AI_HFOS_ENABLED=false             # Enable AI-HFOS
QT_AI_HFOS_MODE=OBSERVE              # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_HFOS_UPDATE_INTERVAL=60        # Coordination cycle interval (seconds)

# AI-HFOS Risk Modes (set automatically based on system state)
# - SAFE: 60% position sizing, conservative threshold
# - NORMAL: 100% position sizing, normal threshold
# - AGGRESSIVE: 100% sizing, lower threshold
# - CRITICAL: Emergency brake activated

# ==============================================================================
# POSITION INTELLIGENCE LAYER (PIL)
# ==============================================================================
# Classifies positions as WINNER, LOSER, SURVIVOR, TOXIC
# Uses dynamic TP/SL adjustments per classification

QT_AI_PIL_ENABLED=false              # Enable PIL
QT_AI_PIL_MODE=ADVISORY              # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_PIL_CLASSIFICATION_INTERVAL=300 # Re-classify positions every N seconds

# PIL Classification Thresholds
QT_AI_PIL_WINNER_THRESHOLD_R=1.5     # Min R-multiple for WINNER
QT_AI_PIL_WINNER_MAX_DD_PCT=10.0     # Max DD % for WINNER
QT_AI_PIL_TOXIC_MAX_DD_PCT=40.0      # Min DD % for TOXIC
QT_AI_PIL_TOXIC_DURATION_MIN=120     # Min minutes in DD for TOXIC

# ==============================================================================
# PORTFOLIO BALANCER AI (PBA)
# ==============================================================================
# Manages portfolio-level exposure, correlation, concentration

QT_AI_PBA_ENABLED=false              # Enable PBA
QT_AI_PBA_MODE=ADVISORY              # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_PBA_REBALANCE_INTERVAL=600     # Check rebalancing every N seconds

# PBA Limits
QT_AI_PBA_MAX_PORTFOLIO_LEVERAGE=20.0 # Max total leverage
QT_AI_PBA_MAX_SECTOR_EXPOSURE=0.30    # Max 30% in any sector
QT_AI_PBA_MAX_CORRELATION=0.85        # Max correlation between positions
QT_AI_PBA_MAX_SINGLE_POSITION=0.15    # Max 15% per position

# ==============================================================================
# PROFIT AMPLIFICATION LAYER (PAL)
# ==============================================================================
# Amplifies winners via scale-ins, TP extension, hold extension

QT_AI_PAL_ENABLED=false              # Enable PAL
QT_AI_PAL_MODE=ADVISORY              # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_PAL_ANALYSIS_INTERVAL=900      # Check amplification every N seconds

# PAL Thresholds
QT_AI_PAL_MIN_R=1.0                  # Min R-multiple to consider amplification
QT_AI_PAL_MIN_R_SCALE_IN=1.5         # Min R for scale-in
QT_AI_PAL_MIN_R_EXTEND_TP=2.0        # Min R for TP extension
QT_AI_PAL_MIN_R_EXTEND_HOLD=2.5      # Min R for hold extension
QT_AI_PAL_MAX_DD_FOR_AMPLIFY=5.0     # Max DD % to allow amplification

# PAL Actions
QT_AI_PAL_SCALE_IN_MULTIPLIER=1.5    # Scale-in by 1.5x original size
QT_AI_PAL_TP_EXTENSION_FACTOR=1.25   # Extend TP by 25%
QT_AI_PAL_HOLD_EXTENSION_HOURS=12    # Extend hold by 12 hours

# ==============================================================================
# SELF-HEALING SYSTEM
# ==============================================================================
# Detects anomalies and applies recovery actions

QT_AI_SELF_HEALING_ENABLED=false     # Enable Self-Healing
QT_AI_SELF_HEALING_MODE=OBSERVE      # OFF | OBSERVE | PROTECTIVE | AGGRESSIVE
QT_AI_SELF_HEALING_CHECK_INTERVAL=120 # Health check every N seconds

# Self-Healing Thresholds
QT_AI_SELF_HEALING_DD_WARNING=2.0    # Daily DD warning threshold %
QT_AI_SELF_HEALING_DD_CRITICAL=3.5   # Daily DD critical threshold %
QT_AI_SELF_HEALING_WIN_RATE_MIN=0.45 # Min win rate (7-day rolling)
QT_AI_SELF_HEALING_LOSS_STREAK_MAX=5 # Max consecutive losses

# Self-Healing Actions
# - OBSERVE: Log only
# - PROTECTIVE: Apply confidence cap, reduce sizing
# - AGGRESSIVE: Pause trading, emergency close

# ==============================================================================
# MODEL SUPERVISOR
# ==============================================================================
# Monitors model performance and adjusts ensemble weights

QT_AI_MODEL_SUPERVISOR_ENABLED=false # Enable Model Supervisor
QT_AI_MODEL_SUPERVISOR_MODE=ADVISORY # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_MODEL_SUPERVISOR_EVAL_INTERVAL=3600 # Evaluate every N seconds

# Model Performance Thresholds
QT_AI_MODEL_SUPERVISOR_MIN_SHARPE=0.5  # Min Sharpe ratio
QT_AI_MODEL_SUPERVISOR_MIN_WIN_RATE=0.48 # Min win rate
QT_AI_MODEL_SUPERVISOR_MAX_DD=8.0      # Max DD % for model

# Ensemble Weight Adjustment
QT_AI_MODEL_SUPERVISOR_ADJUST_WEIGHTS=false # Auto-adjust ensemble weights
QT_AI_MODEL_SUPERVISOR_MIN_WEIGHT=0.10      # Min weight per model
QT_AI_MODEL_SUPERVISOR_MAX_WEIGHT=0.50      # Max weight per model

# ==============================================================================
# UNIVERSE OS
# ==============================================================================
# Dynamic symbol selection and ranking

QT_AI_UNIVERSE_OS_ENABLED=false      # Enable Universe OS
QT_AI_UNIVERSE_OS_MODE=OBSERVE       # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_UNIVERSE_DYNAMIC=false         # If true, universe changes dynamically

# Universe Tiers
QT_AI_UNIVERSE_L1_SIZE=10            # L1 tier size (highest priority)
QT_AI_UNIVERSE_L2_SIZE=20            # L2 tier size
QT_AI_UNIVERSE_BLACKLIST_ENABLED=true # Enable blacklist filtering

# Universe Criteria
QT_AI_UNIVERSE_MIN_VOLUME_24H=5000000   # Min 24h volume USD
QT_AI_UNIVERSE_MIN_LIQUIDITY=1000000    # Min liquidity
QT_AI_UNIVERSE_MAX_SPREAD_BPS=10        # Max spread in bps

# ==============================================================================
# RISK OS (Already in Production)
# ==============================================================================
# Existing risk management (OrchestratorPolicy, RiskGuard)
# These are already integrated - included here for completeness

QT_AI_RISK_OS_ENABLED=true           # Risk OS is already enabled
QT_AI_ORCHESTRATOR_ENABLED=true      # OrchestratorPolicy enabled

# Orchestrator Settings (existing)
QT_ORCHESTRATOR_MIN_CONFIDENCE=0.45
QT_ORCHESTRATOR_MAX_DAILY_TRADES=50
QT_ORCHESTRATOR_MAX_CONCURRENT_POSITIONS=10
QT_ORCHESTRATOR_MAX_DAILY_DD_PCT=5.0
QT_ORCHESTRATOR_PAUSE_ON_LOSS_STREAK=5

# ==============================================================================
# EXECUTION LAYER MANAGER (AELM)
# ==============================================================================
# Smart order execution (order type, slippage, timing)

QT_AI_AELM_ENABLED=false             # Enable AELM
QT_AI_AELM_MODE=ADVISORY             # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_AELM_SMART_EXEC=false          # Use ML-based execution optimization

# Execution Quality
QT_AI_AELM_MAX_SLIPPAGE_BPS=15       # Max acceptable slippage (bps)
QT_AI_AELM_MAX_SPREAD_BPS=10         # Max acceptable spread (bps)
QT_AI_AELM_ORDER_TYPE_AUTO=false     # Auto-select MARKET vs LIMIT

# Order Type Selection (when AUTO=true)
# - SAFE mode: Use LIMIT orders
# - NORMAL mode: Use MARKET orders
# - AGGRESSIVE mode: Use MARKET orders with urgency

# ==============================================================================
# RETRAINING ORCHESTRATOR
# ==============================================================================
# Automated model retraining and deployment

QT_AI_RETRAINING_ENABLED=false       # Enable Retraining Orchestrator
QT_AI_RETRAINING_MODE=ADVISORY       # OFF | OBSERVE | ADVISORY | ENFORCED
QT_AI_RETRAINING_AUTO_DEPLOY=false   # Auto-deploy retrained models (DANGEROUS!)

# Retraining Triggers
QT_AI_RETRAINING_MIN_SHARPE=0.4      # Retrain if Sharpe < threshold
QT_AI_RETRAINING_MAX_DD=10.0         # Retrain if DD > threshold
QT_AI_RETRAINING_MIN_WIN_RATE=0.40   # Retrain if win rate < threshold
QT_AI_RETRAINING_MIN_DAYS_SINCE=7    # Min days since last retraining

# Retraining Schedule
QT_AI_RETRAINING_CHECK_INTERVAL=86400 # Check daily (seconds)
QT_AI_RETRAINING_DATASET_SIZE=10000   # Training dataset size

# ==============================================================================
# LOGGING & TELEMETRY
# ==============================================================================

# AI Subsystem Logs
QT_AI_LOG_LEVEL=INFO                 # DEBUG | INFO | WARNING | ERROR
QT_AI_LOG_PATH=logs/ai_subsystem.log # AI subsystem log file

# Telemetry
QT_AI_TELEMETRY_ENABLED=false        # Enable detailed telemetry
QT_AI_TELEMETRY_INTERVAL=300         # Log telemetry every N seconds

# ==============================================================================
# HEALTH MONITORING
# ==============================================================================

# Health Check Endpoints
QT_AI_HEALTH_ENABLED=true            # Enable /health/ai endpoint
QT_AI_HEALTH_DETAILED=true           # Include detailed subsystem status

# Health Thresholds
QT_AI_HEALTH_CHECK_INTERVAL=60       # Health check every N seconds
QT_AI_HEALTH_ERROR_THRESHOLD=5       # Max errors before marking unhealthy

# ==============================================================================
# DEVELOPMENT & TESTING
# ==============================================================================

# Debug Mode
QT_AI_DEBUG=false                    # Enable debug logging
QT_AI_DRY_RUN=false                  # Dry-run mode (no actual trades)

# Testing
QT_AI_TEST_MODE=false                # Enable test mode
QT_AI_TEST_SCENARIO=none             # Test scenario: none | winner_scenario | loser_scenario

# ==============================================================================
# RECOMMENDED CONFIGURATIONS
# ==============================================================================

# ---- STAGE 1: OBSERVATION (Default) ----
# All subsystems OFF or OBSERVE mode
# NO enforcement, just logging
#
# QT_AI_INTEGRATION_STAGE=OBSERVATION
# QT_AI_HFOS_ENABLED=true
# QT_AI_HFOS_MODE=OBSERVE
# (All other subsystems disabled)

# ---- STAGE 2: PARTIAL ENFORCEMENT ----
# Enable AI-HFOS, PAL, AELM in ADVISORY mode
#
# QT_AI_INTEGRATION_STAGE=PARTIAL
# QT_AI_HFOS_ENABLED=true
# QT_AI_HFOS_MODE=ADVISORY
# QT_AI_PAL_ENABLED=true
# QT_AI_PAL_MODE=ADVISORY
# QT_AI_AELM_ENABLED=true
# QT_AI_AELM_MODE=ADVISORY

# ---- STAGE 3: FULL COORDINATION ----
# AI-HFOS coordinates all subsystems
#
# QT_AI_INTEGRATION_STAGE=COORDINATION
# QT_AI_HFOS_ENABLED=true
# QT_AI_HFOS_MODE=ENFORCED
# QT_AI_PIL_ENABLED=true
# QT_AI_PIL_MODE=ADVISORY
# QT_AI_PBA_ENABLED=true
# QT_AI_PBA_MODE=ADVISORY
# QT_AI_PAL_ENABLED=true
# QT_AI_PAL_MODE=ADVISORY
# QT_AI_SELF_HEALING_ENABLED=true
# QT_AI_SELF_HEALING_MODE=PROTECTIVE

# ---- STAGE 4: TESTNET AUTONOMY ----
# Full autonomous mode (TESTNET ONLY!)
#
# QT_AI_INTEGRATION_STAGE=AUTONOMY
# (Enable all subsystems in ENFORCED mode)
# WARNING: Validate thoroughly on testnet first!

# ---- STAGE 5: MAINNET ROLLOUT ----
# Conservative mainnet settings
#
# QT_AI_INTEGRATION_STAGE=COORDINATION  # NOT AUTONOMY on mainnet
# QT_AI_HFOS_ENABLED=true
# QT_AI_HFOS_MODE=ENFORCED
# QT_AI_SELF_HEALING_ENABLED=true
# QT_AI_SELF_HEALING_MODE=PROTECTIVE
# QT_AI_PAL_ENABLED=true
# QT_AI_PAL_MODE=ADVISORY
# (Keep most subsystems ADVISORY initially)

# ==============================================================================
# END OF CONFIGURATION
# ==============================================================================

Quantum Trader - Total System Forensics & Truth Map
Date: 2026-02-15
Scope: VPS runtime + Redis + repo snapshot (no assumptions)

DEL A - SYSTEM TRUTH MAP

SYSTEM LAYER (VPS / OS)
Component: VPS host
  - Status: ✅
  - Running: YES
  - Connected to: systemd, Redis
  - Last verified: 2026-02-15
  - Evidence: /etc/os-release (Ubuntu 24.04.3 LTS), uname kernel 6.8.0-90-generic

SYSTEMD SERVICES (quantum-*)
Component: Active services (running)
  - Status: ✅
  - Running: YES
  - Connected to: Redis streams, local ports
  - Last verified: 2026-02-15
  - Evidence: systemctl list-units "quantum-*.service"
  - Services:
    - quantum-ai-engine
    - quantum-apply-layer
    - quantum-autonomous-trader
    - quantum-balance-tracker
    - quantum-cross-exchange-aggregator
    - quantum-exchange-stream-bridge
    - quantum-execution
    - quantum-exit-monitor
    - quantum-feature-publisher
    - quantum-harvest-brain
    - quantum-harvest-proposal
    - quantum-intent-bridge
    - quantum-intent-executor
    - quantum-learning-api
    - quantum-learning-monitor
    - quantum-marketstate
    - quantum-performance-tracker
    - quantum-portfolio-governance
    - quantum-portfolio-state-publisher
    - quantum-position-state-brain
    - quantum-price-feed
    - quantum-reconcile-engine
    - quantum-rl-agent
    - quantum-rl-feedback-v2
    - quantum-rl-monitor
    - quantum-rl-trainer (auto-restart)
    - quantum-universe
    - quantum-universe-service
    - quantum-ensemble-predictor
    - quantum-risk-proposal

Component: Inactive/dead services
  - Status: ❌
  - Running: NO
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: systemctl list-units "quantum-*.service"
  - Services:
    - quantum-ai-strategy-router
    - quantum-bsc
    - quantum-capital-allocation
    - quantum-ceo-brain
    - quantum-clm
    - quantum-clm-minimal
    - quantum-core-health
    - quantum-dashboard-api
    - quantum-diagnostic
    - quantum-ess-watch
    - quantum-execution-result-bridge
    - quantum-exit-intelligence
    - quantum-exit-owner-watch
    - quantum-exposure_balancer
    - quantum-governor
    - quantum-harvest-metrics-exporter
    - quantum-harvest-optimizer
    - quantum-health-gate
    - quantum-heat-gate
    - quantum-ledger-sync
    - quantum-meta-regime
    - quantum-metricpack-builder
    - quantum-p28a3-latency-proof
    - quantum-p35-decision-intelligence
    - quantum-performance-attribution
    - quantum-policy-refresh
    - quantum-policy-sync
    - quantum-portfolio-clusters
    - quantum-portfolio-gate
    - quantum-portfolio-heat-gate
    - quantum-portfolio-intelligence
    - quantum-portfolio-risk-governor
    - quantum-retrain-worker
    - quantum-risk-brain
    - quantum-risk-safety
    - quantum-rl-policy-publisher
    - quantum-rl-shadow-metrics-exporter
    - quantum-rl-shadow-scorecard
    - quantum-rl-sizer
    - quantum-safety-telemetry
    - quantum-strategic-memory
    - quantum-strategy-brain
    - quantum-stream-recover (oneshot, not active)
    - quantum-trading_bot
    - quantum-training-worker
    - quantum-utf-publisher
    - quantum-verify-ensemble
    - quantum-verify-rl

Component: Not found (unit missing)
  - Status: ❌
  - Running: NO
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: systemctl list-units "quantum-*.service"
  - Services: quantum-ensemble.service, quantum-redis.service

Component: Watchdogs / restart loops
  - Status: ⚠️
  - Running: YES (unstable)
  - Connected to: systemd
  - Last verified: 2026-02-15
  - Evidence: systemctl show ... NRestarts
  - quantum-exit-monitor: NRestarts=16699, Active=active, Sub=running
  - quantum-rl-trainer: NRestarts=4193, Active=activating, Sub=auto-restart, ExecStart status=203

Component: Timers
  - Status: ⚠️
  - Running: PARTIAL
  - Connected to: systemd timers
  - Last verified: 2026-02-15
  - Evidence: systemctl list-timers "quantum-*.timer"
  - Scheduled: quantum-stream-recover.timer, quantum-policy-sync.timer, quantum-verify-rl.timer, quantum-exit-owner-watch.timer, quantum-verify-ensemble.timer
  - Last run missing (LAST='-'): quantum-policy-refresh.timer, quantum-core-health.timer, quantum-diagnostic.timer, quantum-ess-watch.timer, quantum-health-gate.timer, quantum-ledger-sync.timer, quantum-p28a3-latency-proof.timer, quantum-rl-shadow-scorecard.timer

REDIS - ACTUAL STATE
Component: Redis keyspace
  - Status: ✅
  - Running: YES
  - Connected to: Streams listed below
  - Last verified: 2026-02-15
  - Evidence: redis-cli info keyspace
  - Keyspace: db0 keys=65407, expires=2467

AI / ML LAYER
Component: Model files on disk
  - Status: ⚠️
  - Running: N/A
  - Connected to: /home/qt/quantum_trader/models
  - Last verified: 2026-02-15
  - Evidence: ls -la /home/qt/quantum_trader/models
  - Files observed: nhits, patchtst, tft, xgboost, lgbm

Component: Model load evidence (ai-engine logs)
  - Status: ⚠️
  - Running: YES (ai-engine)
  - Connected to: journalctl -u quantum-ai-engine
  - Last verified: 2026-02-15
  - Evidence: logs show "dummy fallback, no model" for NHiTS and PatchTST on multiple symbols
  - Loaded model per symbol: UKJENT / IKKE BEKREFTET

FRONTEND / UI / MONITORING
Component: QuantumFond UI
  - Status: ❌
  - Running: NO
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: systemctl list-units "quantumfond*" (0 units), ss -lntp (only 8001/8002/8003 open)

REPO & CODE STRUCTURE (VERIFIABLE ONLY)
Component: SYSTEM_INVENTORY.yaml
  - Status: ⚠️
  - Running: N/A
  - Connected to: repo file
  - Last verified: 2026-02-15
  - Evidence: SYSTEM_INVENTORY.yaml last_update=2025-12-21 (historical)

Component: module_registry.json
  - Status: ⚠️
  - Running: N/A
  - Connected to: repo file
  - Last verified: 2026-02-15
  - Evidence: module_registry.json generated_at=2026-01-17, conflicts with current systemd state

Component: Module usage/imports
  - Status: ⚠️
  - Running: UKJENT
  - Connected to: repo tree
  - Last verified: 2026-02-15
  - Evidence: NOT CHECKED in this report (requires code-level import scan)

ENGINES & BRAIN MODULES (RUNTIME ONLY)
Component: AI Engine
  - Status: ✅
  - Running: YES
  - Connected to: Redis streams (ai.decision.made, ai.signal_generated, trade.intent)
  - Last verified: 2026-02-15
  - Evidence: systemd active + Redis stream events with source=ai-engine

Component: Risk Kernel / Risk Safety
  - Status: ❌
  - Running: NO
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: quantum-risk-safety inactive

Component: Exit / Harvest Brain
  - Status: ⚠️
  - Running: PARTIAL
  - Connected to: Redis streams (harvest.intent, trade.closed)
  - Last verified: 2026-02-15
  - Evidence: quantum-harvest-brain active; autonomous_trader writing trade.closed

Component: Capital Allocation
  - Status: ❌
  - Running: NO
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: quantum-capital-allocation inactive

Component: Signal / AI Advisory
  - Status: ✅
  - Running: YES
  - Connected to: ai.decision.made, ai.signal_generated
  - Last verified: 2026-02-15
  - Evidence: ai-engine logs and Redis events

Component: Emergency Exit Worker
  - Status: ⚠️
  - Running: UKJENT
  - Connected to: UKJENT
  - Last verified: 2026-02-15
  - Evidence: No dedicated unit confirmed

Component: Watchdogs
  - Status: ⚠️
  - Running: YES (unstable)
  - Connected to: systemd restart counters
  - Last verified: 2026-02-15
  - Evidence: quantum-exit-monitor and quantum-rl-trainer restart counters

ENV / CONFIG
Component: /etc/quantum env files
  - Status: ⚠️
  - Running: N/A
  - Connected to: systemd EnvironmentFiles
  - Last verified: 2026-02-15
  - Evidence: /etc/quantum directory listing; systemctl show ... EnvironmentFiles
  - Used by active services: intent-executor.env, apply-layer.env, position-state-brain.env, balance-tracker.env, exchange-stream-bridge.env, marketstate.env, harvest-proposal.env, risk-proposal.env, harvest-brain.env, portfolio-state-publisher.env, cross-exchange-aggregator.env, ai-engine.env, testnet.env, core_gates.env, rl-monitor (no env file), learning-api (no env file), learning-monitor (no env file), performance-tracker (no env file), feature-publisher (no env file), universe-service.env, reconcile-engine.env, exit-monitor (testnet.env), intent-bridge.env, price-feed.env (ignore_errors=yes), autonomous-trader.env, rl-agent (no env file), ensemble-predictor (no env file)
  - Inconsistencies: UKJENT / NOT CHECKED (values not compared)
  - Shadow vs prod leaks: UKJENT / NOT CHECKED

AUDIT & LOGGING
Component: Trade history logging
  - Status: ✅
  - Running: YES
  - Connected to: quantum-trade-logger.service
  - Last verified: 2026-02-15
  - Evidence: systemd active

Component: Log rotation
  - Status: ❌
  - Running: NO
  - Connected to: system logging
  - Last verified: 2026-02-15
  - Evidence: logrotate.service failed

DEL B - WHAT ACTUALLY WORKS
- Market data ingestion: quantum:stream:exchange.raw has fresh events and active consumer group (ai-engine)
- AI signals: quantum:stream:ai.decision.made and quantum:stream:ai.signal_generated have fresh events (source=ai-engine)
- Intent pipeline: quantum:stream:trade.intent has fresh events with active consumer groups (intent_bridge, execution)
- Apply pipeline: quantum:stream:apply.plan and quantum:stream:apply.result have fresh events with active consumer groups
- Autonomous exits: quantum:stream:trade.closed has fresh events (source=autonomous_trader)

DEL C - WHAT IS BROKEN / DEAD
- quantum-rl-trainer: auto-restart loop (NRestarts=4193, status=203)
- quantum-exit-monitor: high restart count (NRestarts=16699)
- Risk controls inactive: quantum-risk-safety, quantum-governor, quantum-exposure_balancer, quantum-portfolio-risk-governor
- Dead streams: quantum:stream:market.tick, quantum:stream:market.klines, quantum:stream:policy.updated, quantum:stream:apply.plan.manual, quantum:stream:reconcile.close are length=0
- Missing units: quantum-ensemble.service, quantum-redis.service are not found
- Frontend not running: no quantumfond units, no public port 8000/8025 listeners
- logrotate.service failed (global logging hygiene risk)

DEL D - SYSTEMIC ROOT CAUSES
- Config drift: runtime systemd state conflicts with repo inventories and registries
- Fragmented control plane: many enabled units are inactive; multiple timers have not run in > 1 week
- Model/runtime mismatch: models exist on disk but AI engine logs show dummy fallback; loaded model per symbol is NOT CONFIRMED
- Event ownership gaps: several streams have data but no consumer groups; others have groups but zero events

DEL E - RISK CLASSIFICATION
- P0: quantum-exit-monitor restart loop (exit behavior stability risk)
- P0: quantum-rl-trainer auto-restart (RL training effectively down)
- P1: critical risk services inactive (risk controls not enforced)
- P1: market.tick and market.klines empty (data inputs missing)
- P2: logrotate failed (log growth, reduced traceability)

REDIS STREAMS - TRUTH TABLE

STREAM | PRODUSER | CONSUMER | AKTIV? | SIST EVENT
- quantum:stream:trade.closed | autonomous_trader | quantum:group:ai-engine:trade.closed | YES | 2026-02-15T16:11:39.882960
- quantum:stream:harvest.intent | UKJENT | intent_executor_harvest | YES | 1771171927 (epoch)
- quantum:stream:ai.decision.made | ai-engine | none | YES | 2026-02-15T15:03:31.923368
- quantum:stream:risk.events | UKJENT | none | YES | 1770512865.4193215 (epoch)
- quantum:stream:portfolio.state | portfolio-state-publisher | none | YES | 1771193790 (epoch)
- quantum:stream:reconcile.close | UKJENT | apply_recon | NO | 0-0
- quantum:stream:rl_rewards | UKJENT | none | YES | 2026-02-15T16:06:48.361232+00:00
- quantum:stream:policy.audit | UKJENT | none | YES | 1770667391 (epoch)
- quantum:stream:trade.intent | ai-engine | intent_bridge, execution | YES | 2026-02-15T15:06:08.327496
- quantum:stream:marketstate | UKJENT | none | YES | 1771193759 (epoch)
- quantum:stream:apply.plan.manual | UKJENT | intent_executor_manual | NO | 0-0
- quantum:stream:market.tick | UKJENT | feature_publisher, ai-engine market.tick | NO | 0-0
- quantum:stream:policy.updated | UKJENT | ai-engine policy.updated | NO | 0-0
- quantum:stream:policy.update | UKJENT | none | YES | 1770667391.7833147 (epoch)
- quantum:stream:bsc.events | UKJENT | none | YES | 2026-02-10T23:32:27.519610+00:00
- quantum:stream:exitbrain.pnl | UKJENT | none | YES | UKJENT (no timestamp field)
- quantum:stream:exchange.raw | UKJENT | ai-engine exchange.raw | YES | 1771171560 (epoch)
- quantum:stream:market.klines | UKJENT | ai-engine market.klines | NO | 0-0
- quantum:stream:ai.exit.decision | UKJENT | autonomous-trader:exit-listeners | YES | 1771171927 (epoch)
- quantum:stream:exchange.normalized | UKJENT | feature_publisher, ai-engine exchange.normalized | YES | 1771171560 (epoch)
- quantum:stream:reconcile.events | UKJENT | none | YES | 1771193643 (epoch)
- quantum:stream:position.snapshot | balance-tracker | none | YES | 1771171881 (epoch)
- quantum:stream:apply.result | UKJENT | harvest_brain:execution, execution trade.intent, trade_history_logger | YES | 1771193788 (epoch)
- quantum:stream:features | UKJENT | ensemble_predictor | YES | 2026-02-15T16:06:43.252743Z
- quantum:stream:account.balance | UKJENT | none | YES | 1771193722 (epoch)
- quantum:stream:ai.signal_generated | ai-engine | none | YES | 2026-02-15T15:01:44.061181
- quantum:stream:signal.score | UKJENT | none | YES | 2026-02-15T16:06:43.255320Z
- quantum:stream:execution.result | execution-service | none | YES | 2026-02-09T23:20:25.849704Z
- quantum:stream:apply.plan | UKJENT | apply_layer_entry, governor, intent_executor, p33 | YES | 1771193682 (epoch)

SLUTTORD
Hvis systemet stoppes i dag, er dette de TOPP 5 grunnene:
1) quantum-exit-monitor restart loop (16699 restarts)
2) quantum-rl-trainer auto-restart (status=203)
3) Risiko-tjenester inactive (risk-safety, governor, exposure_balancer)
4) market.tick og market.klines er tomme
5) Konfigurasjonsdrift mellom repo og VPS runtime
